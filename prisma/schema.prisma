generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Patient {
  id             String      @id @default(cuid())
  userId         String
  nome           String
  dataNascimento DateTime?
  createdAt      DateTime    @default(now())
  updatedAt      DateTime    @updatedAt
  dailyNotes     DailyNote[]

  @@index([userId])
  @@map("patients")
}

model DailyNote {
  id             String       @id @default(cuid())
  data           DateTime     @default(now())
  horaDormiu     String?
  horaAcordou    String?
  humor          Int?
  detalhesExtras String?
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
  patientId      String
  tags           String[]     @default([])
  patient        Patient      @relation(fields: [patientId], references: [id], onDelete: Cascade)
  hourlyNotes    HourlyNote[]

  @@index([patientId])
  @@index([data])
  @@map("daily_notes")
}

model HourlyNote {
  id          String    @id @default(cuid())
  hora        String
  descricao   String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  dailyNoteId String
  dailyNote   DailyNote @relation(fields: [dailyNoteId], references: [id], onDelete: Cascade)

  @@index([dailyNoteId])
  @@map("hourly_notes")
}
