generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

// Modelo de Paciente
model Patient {
  id             String      @id @default(cuid())
  userId         String
  nome           String
  dataNascimento DateTime?
  createdAt      DateTime    @default(now())
  updatedAt      DateTime    @updatedAt
  dailyNotes     DailyNote[]

  @@index([userId])
  @@map("patients")
}

// Modelo de Anotação Diária
model DailyNote {
  id             String       @id @default(cuid())
  data           DateTime     @default(now())
  horaDormiu     String?      // Formato: "22:30"
  horaAcordou    String?      // Formato: "07:00"
  humor          Int?         // Escala de 1 a 5
  detalhesExtras String?      @db.Text
  tags           String[]     @default([]) // Array de strings com as tags (máx 30 caracteres cada)
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  // Relações
  patientId      String
  patient        Patient      @relation(fields: [patientId], references: [id], onDelete: Cascade)
  hourlyNotes    HourlyNote[]

  @@index([patientId])
  @@index([data])
  @@map("daily_notes")
}

// Modelo de Anotação por Hora
model HourlyNote {
  id          String    @id @default(cuid())
  hora        String    // Formato: "08:00", "14:30"
  descricao   String    @db.Text
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  // Relações
  dailyNoteId String
  dailyNote   DailyNote @relation(fields: [dailyNoteId], references: [id], onDelete: Cascade)

  @@index([dailyNoteId])
  @@map("hourly_notes")
}
